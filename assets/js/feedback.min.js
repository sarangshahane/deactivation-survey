(i=>{let e={slug:"",skipButton:"",formWrapper:"",radioButton:"",closeButton:"",feedbackForm:"",feedbackInput:"",deactivateUrl:"",buttonTrigger:"",deactivateButton:"",submitDeactivate:"",_cacheElements(){this.slug=udsVars?._plugin_slug||"",this.skipButton=i(".uds-feedback-skip"),this.submitDeactivate=i(".uds-feedback-submit"),this.deactivateButton=i("#the-list").find(".row-actions span.deactivate a"),this.feedbackForm=i(".uds-feedback-form"),this.feedbackInput=i(".uds-options-feedback"),this.formWrapper=i(".uds-feedback-form--wrapper"),this.closeButton=i(".uds-feedback-form--wrapper .uds-close"),this.radioButton=i(".uds-reason-input")},_showPopup(e){i("#deactivation-survay-"+e).addClass("show_popup")},_hidePopup(){this.formWrapper.removeClass("show_popup")},_redirectOrReload(){this.deactivateUrl?window.location.href=this.deactivateUrl:location.reload()},_hideShowFeedbackAndCTA(e){var t="true"===i(e.target).attr("data-accept_feedback"),a="true"===i(e.target).attr("data-show_cta");i(e.target).closest(this.formWrapper).find(".uds-options-feedback").removeClass("hide").addClass(t?"show":"hide"),i(e.target).closest(this.formWrapper).find(".uds-option-feedback-cta").removeClass("hide").addClass(a?"show":"hide")},_changePlaceholderText(e){var t=e.target.getAttribute("data-placeholder");i(e.target).closest(this.formWrapper).find(this.feedbackInput).attr("placeholder",t||""),this._hideShowFeedbackAndCTA(e)},_submitFeedback(e,s){e.preventDefault();var e=i(e.target),t=e.closest(this.feedbackForm),t={action:"uds_plugin_deactivate_feedback",security:udsVars?._ajax_nonce||"",reason:t.find(this.radioButton.filter(":checked")).val()||"",source:t.find('input[name="source"]').val()||"",referer:t.find('input[name="referer"]').val()||"",version:t.find('input[name="version"]').val()||"",feedback:t.find(this.feedbackInput).val()||""};e.find(this.submitDeactivate).text("Deactivating.").addClass("processing"),i.ajax({url:udsVars?.ajaxurl,type:"POST",data:t,success(e){e.success&&s._redirectOrReload(),s._hidePopup()},error(e,t,a){s._redirectOrReload()}})},_handleClick(e){e.target.classList.contains("show_popup")&&e.target.closest(".uds-feedback-form--wrapper")?this._hidePopup():e.target.classList.contains("activate")&&(this.deactivateUrl=e.target.href,-1===this.deactivateUrl.indexOf(`stylesheet=${udsVars?._current_theme}-child`))&&(e.preventDefault(),this._showPopup(udsVars?._current_theme))},_init(){this._cacheElements(),this._bind()},_bind(){let a=this;this.deactivateButton.on("click",function(e){var t=i(e.target).closest("tr").data("slug");a.slug.includes(t)&&(e.preventDefault(),a.deactivateUrl=i(e.target).attr("href"),a._showPopup(t))}),this.closeButton.on("click",function(e){e.preventDefault(),a._hidePopup()}),this.radioButton.on("click",function(e){a._changePlaceholderText(e)}),this.submitDeactivate.add(this.skipButton).on("click",function(e){e.preventDefault(),i(e.target).closest(a.feedbackForm).submit()}),this.feedbackForm.on("submit",function(e){a._submitFeedback(e,a)}),document.addEventListener("click",function(e){a._handleClick(e)})}};i(function(){e._init()})})(jQuery);